{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{444:function(s,n,e){\"use strict\";e.r(n);var a=e(1),t=Object(a.a)({},(function(){var s=this,n=s._self._c;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[n(\"p\",[s._v(\"持续创作，加速成长！这是我参与「掘金日新计划 · 10 月更文挑战」的第9天，\"),n(\"a\",{attrs:{href:\"https://juejin.cn/post/7147654075599978532\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"点击查看活动详情\"),n(\"OutboundLink\")],1)]),s._v(\" \"),n(\"p\",[s._v(\"相信大家也知道大部分的网页版引应用，“不登录就不给看！”，于是，我也给自己的项目添加了这个小细节。如何实现呢？当然是使用路由守卫啦。\")]),s._v(\" \"),n(\"p\",[s._v(\"正如其名，导航守卫就是通过跳转或取消的方式守卫导航。这里使用的vue-router提供的导航守卫。\")]),s._v(\" \"),n(\"h2\",{attrs:{id:\"没有守卫时\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#没有守卫时\"}},[s._v(\"#\")]),s._v(\" 没有守卫时\")]),s._v(\" \"),n(\"p\",[s._v(\"以vue3为例，使用脚手架搭建项目， 命令代码：\"),n(\"em\",[s._v(\"npm init vue@latest\")]),s._v(\"。选择所需的插件，其中因为方便举例，这里都是会话缓存（用到时再解释），没有使用其他状态管理器，如vuex或者pinia...。需要安装vue-router，接下来的改变都是以最初始的页面为基础（接下来就同意称之为基础页面），进行添加路由守卫。\")]),s._v(\" \"),n(\"p\",[s._v(\"登录页面和首页页面：\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v('//登录页面 views/LoginView.vue\\n<template>\\n    <div class=\"login\">\\n        <h1>This is an login page</h1>\\n        用户名：<input type=\"text\" v-model=\"formState.username\" />\\n        <div class=\"btn\" style=\"margin-top: 20px;\">\\n            <button @click=\"onFinish\">登录</button>\\n        </div>\\n    </div>\\n</template>\\n​\\n//登录页面 js代码\\n<script>\\n    //...引入defineComponent\\n    export default defineComponent({\\n        setup() {\\n            const formState = reactive({\\n                username: \\'\\'\\n            })\\n            const onFinish = async () => {\\n                console.log(\\'success\\', formState.username)\\n            }\\n            return {\\n                formState,\\n                onFinish\\n            }\\n        }\\n    })\\n<\\/script>\\n​\\n//首页页面 /views/HomeView.vue\\n<template>\\n    <div class=\"home\">\\n        <h1>This is an home page</h1>\\n    </div>\\n</template>\\n')])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),n(\"br\")])]),n(\"p\",[s._v(\"配置路由：\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"//路由配置 router/index.js\\n//...一些引入\\n​\\nconst router = createRouter({\\n    history: createWebHistory(\\n        import.meta.env.BASE_URL),\\n    routes: [{\\n            path: '/',\\n            redirect: '/home'\\n        },\\n        {\\n            path: '/home',\\n            name: 'home',\\n            component: () => import('../views/HomeView.vue')\\n        },\\n        {\\n            path: '/login',\\n            name: 'login',\\n            component: () => import('../views/LoginView.vue')\\n        }\\n    ]\\n})\\n​\\nexport default router\\n​\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),n(\"br\")])]),n(\"p\",[s._v(\"最开始其实就是准备两个vue3脚手架搭建好两个页面，登录页面和首页页面，然后配置路由即可。\\n看看效果：\")]),s._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/557be3a8e07c4629822ce2a062f7688f~tplv-k3u1fbpfcp-watermark.image?\",alt:\"origin.gif\"}})]),s._v(\" \"),n(\"h2\",{attrs:{id:\"一、全局路由守卫\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#一、全局路由守卫\"}},[s._v(\"#\")]),s._v(\" 一、全局路由守卫\")]),s._v(\" \"),n(\"h3\",{attrs:{id:\"知识基础\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#知识基础\"}},[s._v(\"#\")]),s._v(\" 知识基础\")]),s._v(\" \"),n(\"ul\",[n(\"li\",[n(\"p\",[s._v(\"全局前置守卫\")]),s._v(\" \"),n(\"p\",[s._v(\"可以使用router.beforeEach()注册一个全局前置守卫。当一个导航触发时，全局前置守卫按照创建顺序调用。此时，导航在所有守卫resolve完之前一直处于等待之中。\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"const router = createRouter({ ... })\\nrouter.beforeEach((to, from, next) => {//路由跳转前\\n  if(...){//不存在token\\n     //回到登录页面\\n     return {name:'login'}\\n  }else{\\n      next()//只有调用next()，才能成功跳转；否则不成功\\n  }\\n})\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\")])]),n(\"p\",[s._v(\"参数：\")]),s._v(\" \"),n(\"p\",[s._v(\"（1）to:即将要进入的目标\")]),s._v(\" \"),n(\"p\",[s._v(\"（2）from:当前导航正要离开的路由\")]),s._v(\" \"),n(\"p\",[s._v(\"（3）next：去到下一个导航守卫调用。确保next在任何给定的导航守卫中都被严格调用一次。\")])]),s._v(\" \"),n(\"li\",[n(\"p\",[s._v(\"全局解析守卫\")]),s._v(\" \"),n(\"p\",[s._v(\"使用router.beforeResolve()注册一个全局解析守卫。与全局前置守卫类似，在每次导航时触发，但是在确保导航被触发之前，同时在所有组件内守卫和异步路由组件被解析之后，解析守卫就被正确调用。\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"const router = createRouter({ ... })\\nrouter.beforeResolve((to, from, next) => { //成功调到目的地页面之前\\n    console.log(to, from);\\n    next();\\n})\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\")])])]),s._v(\" \"),n(\"li\",[n(\"p\",[s._v(\"全局后置钩子\")]),s._v(\" \"),n(\"p\",[s._v(\"使用router.afterEach()注册一个全局后置钩子，与守卫不同，它\"),n(\"em\",[s._v(\"不接受next第三个参数\")]),s._v(\"，函数也不会改变导航本身。\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"const router = createRouter({ ... })\\nrouter.afterEach((to, from) => {\\n console.log(to, from);\\n if (!sessionStorage.getItem('age') && to.name !== 'LoginView') {\\n     router.push('LoginView');//以这种方式强制回到登录页面\\n }\\n})\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\")])])])]),s._v(\" \"),n(\"h3\",{attrs:{id:\"路由守卫\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#路由守卫\"}},[s._v(\"#\")]),s._v(\" 路由守卫\")]),s._v(\" \"),n(\"p\",[s._v(\"浏览器缓存：\")]),s._v(\" \"),n(\"ul\",[n(\"li\",[n(\"p\",[s._v(\"本地缓存\")]),s._v(\" \"),n(\"p\",[s._v(\"LocalStorage.setItem(key,value) 设置本地缓存\")]),s._v(\" \"),n(\"p\",[s._v(\"LocalStorage.setItem(key) 获取本地缓存\")]),s._v(\" \"),n(\"p\",[s._v(\"永久性缓存，可手动清除缓存。\")])]),s._v(\" \"),n(\"li\",[n(\"p\",[s._v(\"会话缓存\")]),s._v(\" \"),n(\"p\",[s._v(\"SessionStorage.setItem(key,value) 设置会话缓存\")]),s._v(\" \"),n(\"p\",[s._v(\"SessionStorage.setItem(key) 获取会话缓存\")])])]),s._v(\" \"),n(\"p\",[s._v(\"暂时性缓存，结束会话即缓存清除，可手动清除缓存。\")]),s._v(\" \"),n(\"p\",[s._v(\"在没有做路由守卫页面的基础上，在登录页面增加做缓存的功能：\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"//...登录页面的html代码\\n​\\n<script>\\n    //...一些引入\\n    //...其他代码（标准格式）\\n    const onFinish = async () => {\\n        console.log('success', formState.username)\\n                \\n       //这里是新添加的做缓存功能代码\\n       // 假设拿到后端数据，接下来做缓存，比如在xxxx天后登录失效\\n      if (formState.username) {\\n             //设置会话缓存\\n            sessionStorage.setItem('username', formState.username)\\n            //路由跳转\\n             router.push('/home')\\n      } else {\\n           alert('用户名为空')\\n     }\\n                \\n    }\\n    //...其他代码（标准格式）\\n<\\/script>\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),n(\"br\")])]),n(\"p\",[s._v(\"接下来，在全局设置路由守卫，即在搭建的基础之上，添加路由守卫代码。\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"//全局路由守卫：main.js\\n//...一些引入\\n​\\n// 全局路由守卫----全局前置守卫\\nrouter.beforeEach((to, from, next) => { //路由跳转前\\n    // console.log(to, from);\\n    // 判断是否在缓存，在的话允许访问首页；否则，跳回登录页面\\n   if (!sessionStorage.getItem('username') && to.name !== 'login') {//不存在\\n        return next({//去登录页面\\n            name: 'login'\\n        })\\n    } else {//存在，允许去你想要的页面\\n        next(); //只有调用next()，才能成功跳转；否则不成功\\n    }\\n})\\n​\\n//...一些use\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),n(\"br\")])]),n(\"p\",[s._v(\"来看看守卫的结果吧：\")]),s._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:\"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4909524945bc403d8aad79347c207e59~tplv-k3u1fbpfcp-watermark.image?\",alt:\"global.gif\"}})]),s._v(\" \"),n(\"h2\",{attrs:{id:\"二、路由独享守卫\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#二、路由独享守卫\"}},[s._v(\"#\")]),s._v(\" 二、路由独享守卫\")]),s._v(\" \"),n(\"h3\",{attrs:{id:\"知识基础-2\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#知识基础-2\"}},[s._v(\"#\")]),s._v(\" 知识基础\")]),s._v(\" \"),n(\"ul\",[n(\"li\",[n(\"p\",[s._v(\"路由独享的守卫\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"const routes = [\\n  {\\n    path: '/users/:id',\\n    component: UserDetails,\\n    beforeEnter: (to, from,next) => {\\n     // return false\\n        if(...){//未登录或者为授权\\n           //强制回到登录页面,或者retun false拒绝导航\\n           next({\\n             name: 'login'\\n           })\\n        }else{ \\n            next()//去到下一个导航守卫\\n        }\\n    },\\n  },\\n]\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),n(\"br\")])]),n(\"p\",[n(\"em\",[s._v(\"路由独享的守卫只有在进入路由时才会触发\")]),s._v(\"，不会再路径改变参数（params）、query、hash等时触发。它只是只有在从一个不同的路由导航时，才会被触发。也可以将函数数组传给beforeEnter，在为不同的路由重用守卫时大有作为。\")])])]),s._v(\" \"),n(\"h3\",{attrs:{id:\"路由守卫-2\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#路由守卫-2\"}},[s._v(\"#\")]),s._v(\" 路由守卫\")]),s._v(\" \"),n(\"p\",[s._v(\"在基础页面上，在你想要守卫的路由组件下面增加路由守卫，如下\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"//路由配置 router/index.js\\n{\\n            path: '/home',\\n            name: 'home',\\n            component: () => import('../views/HomeView.vue'),\\n                \\n             //这里是新添加的路由守卫代码   \\n            // 路由守卫---\\n            beforeEnter: (to, from, next) => {\\n                if (!sessionStorage.getItem('username')) {\\n                    alert('请先登录');\\n                    next({\\n                        name: 'login'\\n                    })\\n                } else {\\n                    next();\\n                }\\n            }\\n            \\n}\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),n(\"br\")])]),n(\"p\",[s._v(\"看看路由守卫结果：\")]),s._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3195889e090c46489c9703d8219005a1~tplv-k3u1fbpfcp-watermark.image?\",alt:\"router.gif\"}})]),s._v(\" \"),n(\"h2\",{attrs:{id:\"三、组件内的守卫\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#三、组件内的守卫\"}},[s._v(\"#\")]),s._v(\" 三、组件内的守卫\")]),s._v(\" \"),n(\"h3\",{attrs:{id:\"知识基础-3\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#知识基础-3\"}},[s._v(\"#\")]),s._v(\" 知识基础\")]),s._v(\" \"),n(\"ul\",[n(\"li\",[n(\"p\",[s._v(\"beforeRouteEnter\")]),s._v(\" \"),n(\"p\",[s._v(\"beforeRouteEnter()一般在\"),n(\"em\",[s._v(\"渲染该组件的对应路由被验证前调用\")]),s._v(\"，但是不能获取组件实例的this，因为当前守卫执行时，组件实例还没被创建。\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"beforeRouteEnter(to, from, next) {\\n            // 进入当前组件\\n            if (...) {//没有满足要求\\n                return next({\\n                    name: 'login'\\n                })\\n            } else {\\n                next(); //只有调用next()，才能成功跳转；否则不成功\\n            }\\n}\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\")])])]),s._v(\" \"),n(\"li\",[n(\"p\",[s._v(\"beforeRouteUpdate\")]),s._v(\" \"),n(\"p\",[s._v(\"beforeRouteUpdate()一般\"),n(\"em\",[s._v(\"在当前路由改变，但是该组件被复用时调用\")]),s._v(\"，如同一个路径下携带参数不一样的情况下。因为路径相同会渲染相同的组件，因此组件实例会被复用，而钩子函数就会在这个时候会被调用。在这种情况下，组件已经挂载就绪，导航守卫可以访问组件实例的this。正是因为可以使用this，所以不支持next的调用。\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\" beforeRouteUpdate(to, from) {\\n    console.log(this)\\n     this.name=to.params.name\\n  },\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\")])])]),s._v(\" \"),n(\"li\",[n(\"p\",[s._v(\"beforeRouteLeave\")]),s._v(\" \"),n(\"p\",[s._v(\"beforeRouteLeave()，离开守卫，通常用来预防用户还在未保存修改之前就突然去其他页面。顾名思义，一般\"),n(\"em\",[s._v(\"在导航离开渲染组件的对应路由时调用\")]),s._v(\"。也可以访问组件实例的this，同时也没有next可以调用。\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"  beforeRouteLeave(to, from) {\\n    console.log(this)\\n      return false//可取消守卫\\n  }\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\")])])])]),s._v(\" \"),n(\"h3\",{attrs:{id:\"路由守卫-3\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#路由守卫-3\"}},[s._v(\"#\")]),s._v(\" 路由守卫\")]),s._v(\" \"),n(\"p\",[s._v(\"组件内的守卫，那么只需要在页面进行路由守卫即可，在基础1页面上，在需要守卫的页面上添加路由守卫：\")]),s._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[s._v(\"//home页面js代码\\n<script>\\n    import {\\n        defineComponent\\n    } from \\\"vue\\\"\\n    export default defineComponent({\\n        beforeRouteEnter(to, from, next) {\\n            // 进入当前组件\\n            if (!sessionStorage.getItem('username') && to.name !== 'login') {\\n                return next({\\n                    name: 'login'\\n                })\\n            } else {\\n                console.log(1233333333333);\\n                next(); //只有调用next()，才能成功跳转；否则不成功\\n            }\\n        }\\n    })\\n<\\/script>\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),n(\"br\")])]),n(\"p\",[s._v(\"看看守卫结果:\")]),s._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:\"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5702335af09843528f29dc88a3d28f47~tplv-k3u1fbpfcp-watermark.image?\",alt:\"component.gif\"}})]),s._v(\" \"),n(\"h2\",{attrs:{id:\"总结\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#总结\"}},[s._v(\"#\")]),s._v(\" 总结\")]),s._v(\" \"),n(\"p\",[s._v(\"全局路由守卫三个钩子函数，全局前置守卫（beforeEach），全局解析守卫（beforeResolve）和全局后置守卫（afterEach），其中全局后置守卫（afterEach）没有next可以调用，即不能传递第三个回调参数next；\")]),s._v(\" \"),n(\"p\",[s._v(\"路由独享的守卫（beforeEnter），只有在进入路由时才会触发；\")]),s._v(\" \"),n(\"p\",[s._v(\"组件内的路由守卫，也有三个api可以使用，分别是beforeRouteEnter，beforeRouteUpdate，beforeRouteLeave，其中因为beforeRouteEnter调用的时候，组件实例还没有被创建，所以只有beforeRouteEnter可以传递第三个回调参数next，因为beforeRouteUpdate，beforeRouteLeave被调用的时候，组件实例已经被挂载就绪，可以访问组件实例的this,所以没必要next的存在了。\")])])}),[],!1,null,null,null);n.default=t.exports}}]);","extractedComments":[]}